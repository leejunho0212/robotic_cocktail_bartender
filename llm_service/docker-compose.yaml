# 사실상 쓰이지 않는 파일입니다.

version: '3.8'

services:
  brain:
    build: .
    container_name: cocktail_brain_container
    
    # [권한 설정] 오디오 하드웨어 접근 권한 부여
    privileged: true
    group_add:
      - audio

    # [환경 변수] 
    environment:
      - GOOGLE_API_KEY=${GOOGLE_API_KEY}
      # 도커에게 "주인님(Host)의 소리 서버를 써라"고 지시
      - PULSE_SERVER=unix:/run/user/1000/pulse/native
      - PULSE_COOKIE=/root/.config/pulse/cookie

    # [볼륨 마운트] 신경망 연결
    volumes:
      - ./src:/ros2_ws/src
      # 호스트의 소리 통로(Socket)를 도커에 연결
      - /run/user/1000/pulse:/run/user/1000/pulse
      # 호스트의 소리 인증키(Cookie)를 도커에 연결 (권한 문제 해결)
      - ~/.config/pulse/cookie:/root/.config/pulse/cookie

    # [장치 연결] 기존 설정 유지
    devices:
      - /dev/snd:/dev/snd
    
    network_mode: host
    tty: true
    stdin_open: true